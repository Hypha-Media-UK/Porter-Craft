{% extends "_layout" %}

{% block content %}
    <div class="building-detail">
        <h1>Building Details</h1>
        
        <div class="building-info">
            <h2>{{ entry.title }}</h2>
            
            <div class="info-card">
                <div class="info-item">
                    <strong>Building Name:</strong> {{ entry.title }}
                </div>
            </div>
            
            <div class="departments-list">
                <h3>Departments in this Building</h3>
                
                {% set departments = craft.entries()
                    .section('departments')
                    .relatedTo(entry)
                    .all() %}
                
                {% if departments|length %}
                    <table class="departments-table">
                        <thead>
                            <tr>
                                <th>Department Name</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for department in departments %}
                                <tr>
                                    <td><a href="{{ department.url }}">{{ department.title }}</a></td>
                                    <td class="actions-column">
                                        <a href="{{ department.cpEditUrl }}" class="btn small">Edit</a>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p><em>No departments have been added to this building yet.</em></p>
                {% endif %}
            </div>
        </div>
        
        <div class="actions">
            <a href="{{ siteUrl('buildings') }}" class="btn back-btn">Back to Buildings List</a>
            <a href="{{ siteUrl('settings') }}" class="btn back-btn">Back to Settings</a>
            <a href="{{ entry.cpEditUrl }}" class="btn edit-btn">Edit Building</a>
        </div>
    </div>
    
    <style>
        .building-detail {
            margin-top: 20px;
        }
        .building-info {
            margin: 20px 0;
        }
        .info-card {
            background-color: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 5px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .info-item {
            margin-bottom: 10px;
        }
        .departments-list {
            margin-top: 30px;
        }
        .departments-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .departments-table th, .departments-table td {
            padding: 10px;
            border: 1px solid #ddd;
        }
        .departments-table th {
            background-color: #f2f2f2;
        }
        .actions-column {
            width: 120px;
            text-align: center;
        }
        .actions {
            margin-top: 30px;
        }
        .back-btn, .edit-btn {
            display: inline-block;
            text-decoration: none;
            margin-right: 10px;
        }
        .btn.small {
            padding: 5px 10px;
            font-size: 0.9em;
        }
    </style>
{% endblock %}
